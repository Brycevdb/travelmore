<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui" xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:head>
    <title>Travel More!</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />

    <link rel="stylesheet" href="style.css"/>
    <link rel="stylesheet" href="styles/fonts.css"/>
    <link rel="stylesheet" href="styles/gatjas_main.css"/>
    <link rel="stylesheet" href="styles/gatjas.css"/>
</h:head>
<h:body>

    <div class="hoofding">
        <h:graphicImage name="/images/banner.jpg" alt="headerlogo"/>
    </div>

    <nav class="paddedExtraSmall widthFull column centered">
        <div class="container-fluid widthMaxed">
            <h:form>
                <ul class="nav navbar-nav">
                    <li><h:commandButton styleClass="navbutton paddedExtraSmall" value="Home" action="#{homeController.index}" /></li>
                    <h:inputHidden value="#{userController.currentUser.id}" id="hiddenId" />

                    <c:if test="#{userController.currentUser.id > 0}">
                        <li><h:commandButton styleClass="navbutton paddedExtraSmall" value="Mijn reizen" action="#{tripOfUserController.index}" /></li>
                    </c:if>
                </ul>
                <div class="navigatie">
                    <ul class="nav navbar-nav navbar-right">
                        <li><h:commandButton styleClass="navbutton paddedExtraSmall" value="#{userController.welcome}" action="#{userController.index}" /></li>
                    </ul>
                </div>
            </h:form>
        </div>
    </nav>

    <div class="widthFull column centered">
        <div class="widthMaxed column margedBig noMargin_left noMargin_right noMargin_bottom">
            <div class="paddedBig column">
                <h2 class="paddedExtraSmall noPadding_left noPadding_right noPadding_top">
                    Zoek uw bestemming
                </h2>

                <p class="readable widthHalf">
                    Zie de wereld, het leven is te kort om niet te weten wat de wereld met zich meebrengt. Zoek naar bestemmingen gans de aardbol rond.
                </p>

                <h:form id="frmSearch" styleClass="widthFull column">
                    <p:autoComplete id="complete" styleClass="widthFull margedSmall noMargin_left noMargin_right noMargin_bottom" value="#{locationController.selected}" var="Location" itemValue="#{Location}" itemLabel="#{Location.name}" converter="#{locationConverter}" completeMethod="#{locationController.autoComplete}">
                        <p:ajax event="itemSelect" listener="#{locationController.setSelect()}" update=":frmTrips:locationDataTable" />
                    </p:autoComplete>
                </h:form>
            </div>
        </div>
    </div>

    <div class="widthFull column centered margedNormal noMargin_left noMargin_right noMargin_bottom lightbacked">
        <div class="widthMaxed column">
            <div class="paddedBig column">
                <h:form id="frmTrips">
                <p:dataTable id="locationDataTable" var="trip" value="#{locationController.selected.trips}" filteredValue="#{locationController.filteredSelected}" widgetVar="tripTabel"
                             emptyMessage="Geen reizen gevonden voor #{locationController.selectedName}">
                    <p:column headerText="Accommodatie">
                        <p:commandButton value="#{trip.accomodation.name}" action="#{accomodationController.showAccomodation(trip.accomodation)}" />
                    </p:column>
                    <p:column headerText="Reis locatie" filterBy="#{trip.accomodation.location.name}" filterMatchMode="contains">
                        <h:outputText value="#{trip.arrival.name}"/>
                    </p:column>
                    <p:column headerText="Vertrek" filterBy="#{trip.locationt.name}" filterMatchMode="contains">
                        <h:outputText value="#{trip.locationt.name}"/>
                    </p:column>
                    <p:column headerText="Start" filterBy="#{trip.accomodation.period.start}" filterFunction="#{locationController.filterByDate}">
                        <f:facet name="filter">
                            <p:calendar id="cal1" pattern="yyyy-MM-dd">
                                <p:ajax event="dateSelect" oncomplete="PF('tripTabel').filter()" update="locationDataTable" />
                                <p:ajax event="change" execute="@this" oncomplete="PF('tripTabel').filter()" update="locationDataTable"/>
                            </p:calendar>
                        </f:facet>
                        <h:outputText value="#{trip.accomodation.period.start}" >
                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                        </h:outputText>
                    </p:column>
                    <p:column headerText="Einde" filterBy="#{trip.accomodation.period.end}" filterFunction="#{locationController.filterByDate}">
                        <f:facet name="filter">
                            <p:calendar id="cal2" pattern="yyyy-MM-dd">
                                <p:ajax event="dateSelect" oncomplete="PF('tripTabel').filter()" update="locationDataTable" />
                                <p:ajax event="change" execute="@this" oncomplete="PF('tripTabel').filter()" update="locationDataTable"/>
                            </p:calendar>
                        </f:facet>
                        <h:outputText value="#{trip.accomodation.period.end}">
                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                        </h:outputText>
                    </p:column>
                    <p:column headerText="Beschikbare plaatsen" filterBy="#{trip.accomodation.freePlaces}" filterFunction="#{locationController.filterByFreeplaces}">
                        <p>#{trip.accomodation.freePlaces}</p>
                    </p:column>
                    <p:column headerText="Prijs per persoon" filterBy="#{trip.accomodation.priceAPerson}" filterFunction="#{locationController.filterByPrice}">
                        <p> â‚¬#{trip.accomodation.priceAPerson}</p>
                    </p:column>
                    <p:column headerText="Transport" filterBy="#{trip.transport.name}" filterMatchMode="contains">
                        <h:outputText value="#{trip.transport.name}"/>
                    </p:column>
                    <p:column>
                        <p:commandButton value="Boeken" action="#{tripController.goToBooking(trip, userController.currentUser)}"/>
                    </p:column>
                </p:dataTable>
            </h:form>
            </div>
        </div>
    </div>

    <div class="widthFull column centered margedNormal noMargin_left noMargin_right noMargin_bottom lightbacked">
        <div class="widthMaxed column">
            <div class="paddedBig column">
                <h2 class="paddedExtraSmall noPadding_left noPadding_right noPadding_top">
                    Moeite met kiezen?
                </h2>

                <p class="readable widthHalf">
                    Dat begrijpen we helemaal. Daarom willen we u graag een stapje verder zetten met deze suggesties.
                </p>

                <p:dataGrid styleClass="margedSmall noMargin_left noMargin_right noMargin_bottom" var="location" value="#{locationController.all}" id="locationDataGrid" columns="5" rows="10">
                    <p:column>
                        <p:panel header="#{location.name}">
                            <h:panelGrid columns="1">
                                <div class="paddedExtraBig noPadding_left noPadding_right locationImage" style='background-image: url("#{location.photourl}")'></div>
                                <h:form>
                                    <h:commandButton styleClass="locationbutton" value="Bekijk accomodaties hier" action="#{locationController.showTrips(location)}" update=":frmSearch:complete :frmTrips:locationDataTable" />
                                </h:form>
                            </h:panelGrid>
                        </p:panel>
                    </p:column>
                </p:dataGrid>
            </div>
        </div>
    </div>

    <ui:include src="footer.xhtml"/>
    <style>
        .footer {
            height: 60px;
            left: 0;
            bottom: 0;
            width: 100%;
            background-color: #011a27;
            color: white;
            text-align: center;

        }
        .footer p {
            padding-top: 20px;
        }
    </style>
</h:body>
</html>
